spring.application.name=aggregate-service
spring.lifecycle.timeout-per-shutdown-phase=30s
# ===============================
# Server Configuration
# ===============================
server.port=9094
server.shutdown=graceful
server.netty.connection-timeout=3s
server.netty.idle-timeout=20s

# === Spring Cloud Config ===
spring.config.import=${configserver.import}
spring.cloud.config.import-check.enabled=false
spring.cloud.config.request-connect-timeout=5000
spring.cloud.config.request-read-timeout=5000
spring.cloud.config.fail-fast=false
spring.cloud.config.retry.max-attempts=6
spring.cloud.config.retry.initial-interval=1000
spring.cloud.config.retry.max-interval=2000
spring.cloud.config.retry.multiplier=1.1
configserver.import=optional:configserver:${CONFIG_SERVER_URL:http://localhost:9095}
# ===============================
# External Service URLs
# ===============================
external.course-service-url=http://localhost:9091
external.feedback-service-url=http://localhost:9093
external.course-path=/v1/courses
external.course-feedbacks-path=/v1/feedbacks/course
external.course-ratings-path=/v1/feedbacks/ratings
external.default-timeout=2s
external.retry-backoff=100ms
external.retry-count=5
external.retry-jitter=0.75

# ===============================
# Resilience4j CircuitBreaker
# ===============================
resilience4j.circuitbreaker.configs.default.sliding-window-type=time_based
resilience4j.circuitbreaker.configs.default.sliding-window-size=30
# Window duration in seconds

resilience4j.circuitbreaker.configs.default.permitted-number-of-calls-in-half-open-state=5
resilience4j.circuitbreaker.configs.default.failure-rate-threshold=60
# Failure percentage threshold

resilience4j.circuitbreaker.configs.default.wait-duration-in-open-state.seconds=10
resilience4j.circuitbreaker.configs.default.slow-call-duration-threshold.seconds=4
# Number of calls used to decide whether to open/close the CircuitBreaker.
# Since we use TIME_BASED window type, this number of calls must occur
# within the specified sliding-window-size time.
resilience4j.circuitbreaker.configs.default.minimum-number-of-calls=15

# CircuitBreaker instances
resilience4j.circuitbreaker.instances.courseBackend.base-config=default
resilience4j.circuitbreaker.instances.feedbackBackend.base-config=default

# ===============================
# Resilience4j Retry
# ===============================
resilience4j.retry.configs.default.max-attempts=${external.retry-count}
# Maximum number of retry attempts (incl. 1st attempt)

resilience4j.retry.configs.default.wait-duration.seconds=${external.retry-backoff}
# Wait duration between retry attempts

resilience4j.retry.configs.default.enable-exponential-backoff=true
# Enables exponential backoff (waiting time) between retries

resilience4j.retry.configs.default.exponential-backoff-multiplier=2
# Multiplier for exponential backoff (waiting time) increase

resilience4j.retry.configs.default.enable-randomized-wait=true
# Enables random delay between retries

resilience4j.retry.configs.default.randomized-wait-factor=${external.retry-jitter}
# The actual wait time will vary by the retry-jitter percentage

resilience4j.retry.configs.default.retry-exceptions=at.aggregate_service.exception.CourseAggregateException
# Exceptions that trigger retry attempts

resilience4j.retry.configs.default.ignore-exceptions=io.github.resilience4j.circuitbreaker.CallNotPermittedException
# Exceptions that should not trigger retries

# Retry instances
resilience4j.retry.instances.courseBackend.base-config=default
resilience4j.retry.instances.feedbackBackend.base-config=default

# ===============================
# SpringDoc / Swagger Configuration
# ===============================
springdoc.api-docs.path=/api-docs
springdoc.swagger-ui.path=/swagger-ui.html

# ===============================
# API Documentation Metadata
# ===============================
api.get-aggregate.summary=Get detailed course information by ID.
api.get-aggregate.description=Provides course information, user feedback, and rating data. \
If rating or feedback information cannot be retrieved, a partial response is returned with an error message. \
The feedback list is sorted and paginated according to the query parameters. \
Sorting options: \
- date_asc: by creation date (oldest first) \
- date_desc: by creation date (newest first)

api.get-aggregate-list.summary=Get a list of courses and their ratings from a specific category.
api.get-aggregate-list.description=Provides a list of courses including additional data: \
- rating \
- average score \
The list is sorted according to the query parameters. \
Sorting options: \
- az / za: alphabetically \
- date_asc / date_desc: by creation date \
- price_asc / price_desc: by price \
- rate_asc / rate_desc: by rating

api.response.getAggregateOk=Course information successfully generated.
api.response.getAggregateListOk=Course list successfully generated.
api.response.notFound=Course with the specified ID was not found.
api.response.badRequest=Response could not be generated due to invalid input parameters. See error message for details.
api.response.serviceUnavailable=Response could not be generated due to one of the external systems being unavailable. See error message for details.


